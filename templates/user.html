<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>User</title>
    <link type="text/css" rel="stylesheet" href="/static/css/userpage.css">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="{{
  url_for('static', filename='jquery3.6.0.js') }}">\x3C/script>')</script>
    <script type=text/javascript>
        $SCRIPT_ROOT = {{ request.script_root|tojson }};
    </script>
    <script type="text/javascript" src="{{ url_for("static", filename="up.js") }}"></script>
</head>
<body>
<div class="left-row">
    <a>Profile</a><br>
    <a href="{{ url_for("user_settings") }}" class="settings">Settings</a><br>
    <a href="{{ url_for("messages")}}">Messages</a><br>
    <a href="{{ url_for("friends_page") }}">Friends</a><br>
    <a href="{{ url_for("user_groups") }}">Communities</a><br>
    <a>Your characters</a><br>
</div>
<div class="middle-row">
    <a class="userDescription">{{ descrip }}</a>
    <div class="create_post">
        <textarea id="user_post"></textarea>
        {% if name == session['username'] %}
        <label for="view_level">Select post view level</label>
        <select name="view_level" id="view_level">
            <option value="5">5 (For everyone)</option>
            <option value="4">4</option>
            <option value="3">3</option>
            <option value="2">2</option>
            <option value="1">1</option>
            <option value="0">0 (Just for you)</option>
        </select>
        {% endif %}
        <button id="publish_post">Make post</button>
    </div>
    <div class="posts">
        {% for post in posts %}
            <a class="userPost">{{ post }}</a><br>
        {% endfor %}
    </div>
</div>
<div class="right-row">
    <div class="profile">
        <a>{{ name }}</a>
        <a>{{ v_lvl }}</a>
    </div>
    {% if name != session['username'] %}
        <div class="friend_buttons">
            <button id="add_friend" value="Add friend">Add friend</button>
            <button id="remove_friend" value="">Remove friend</button>
            <button id="decline_request" value="">Decline request</button>
            <button id="accept_request" value="">Accept request</button>
            <button id="cancel_request" value="">Cancel request</button>
        </div>
    {% endif %}
    <div class="Logout"><a href={{ url_for('logout') }}>Log out</a></div>
</div>
</body>
<script type="text/javascript">
    init("{{name}}", "{{session.get("username")}}");
    $("#add_friend").click(function () {
        add_friend('{{name}}')
    })
    $("#cancel_request").click(function () {
        remove_friend('{{name}}')
    })
    $("#accept_request").click(function () {
        accept_request('{{ name }}')
    })
    $("#decline_request").click(function () {
        remove_friend('{{ name }}')
    })
    $("#remove_friend").click(function () {
        remove_friend('{{ name }}')
    })
    $(function () {
        $("#publish_post").click( function () {
            {% if v_lvl == 0 %}
            let view_lvl = document.getElementById("view_level").value
            let whereid = null
            let fromid = null
            {% else %}
            let view_lvl = {{v_lvl}}
            let whereid = "{{name}}"
            let fromid = "{{session.get('username')}}"
            {% endif %}
            publish_post($("#user_post").val(), null, view_lvl, whereid, fromid)
        })
    })
</script>
</html>
<!--TODO: Make some design for user page--> 